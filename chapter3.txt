this is chapter 3 in experimental 2 branch
